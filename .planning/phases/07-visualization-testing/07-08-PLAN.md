---
phase: 07-visualization-testing
plan: 08
type: execute
wave: 1
depends_on: []
files_modified:
  - analysis/cli/chief.py
  - analysis/cli/forecasting.py
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "User can specify --output-format (png, svg, pdf) on Chief CLI commands"
    - "User can specify --output-format (png, svg, pdf) on Forecasting CLI commands"
    - "CLI commands accept and store output_format parameter"
    - "Default output format is png when not specified"
  artifacts:
    - path: "analysis/cli/chief.py"
      provides: "Chief CLI commands with --output-format argument"
      contains: "output_format: Literal['png', 'svg', 'pdf']"
    - path: "analysis/cli/forecasting.py"
      provides: "Forecasting CLI commands with --output-format argument"
      contains: "output_format: Literal['png', 'svg', 'pdf']"
  key_links:
    - from: "analysis/cli/chief.py"
      to: "typer.Option"
      via: "output_format parameter with default 'png'"
      pattern: "output_format.*typer\.Option.*png"
    - from: "analysis/cli/forecasting.py"
      to: "typer.Option"
      via: "output_format parameter with default 'png'"
      pattern: "output_format.*typer\.Option.*png"
---

<objective>
Add --output-format CLI argument to Chief and Forecasting commands.

This plan adds the --output-format argument to all Chief (trends, seasonality, covid) and Forecasting (time-series, classification) CLI commands. This is the first step in closing the gap where users cannot specify figure output formats via the CLI.

Purpose: Enable users to specify PNG, SVG, or PDF output format for figures generated by CLI commands.
Output: Updated CLI commands with --output-format argument (default: png).
</objective>

<execution_context>
@/Users/dustinober/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dustinober/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/07-visualization-testing/07-VERIFICATION.md
@.planning/phases/07-visualization-testing/07-01-SUMMARY.md
@analysis/visualization/__init__.py
@analysis/cli/chief.py
@analysis/cli/forecasting.py

Gap reason from VERIFICATION.md:
- "CLI commands do not have --output-format argument implemented. save_figure() function exists but CLI does not expose it."
- Missing: "--output-format CLI argument on all 13 CLI commands"

What exists (from 07-01 SUMMARY):
- Visualization module is complete with save_figure(), setup_style(), plot functions
- All exports are accessible via `from analysis.visualization import ...`
- Testing infrastructure is complete (27 CLI tests, all passing)

What needs to be added:
- --output-format CLI argument on Chief commands (trends, seasonality, covid)
- --output-format CLI argument on Forecasting commands (time-series, classification)
- Pass output_format parameter through to figure generation (plan 07-10)
</context>

<tasks>

<task type="auto">
  <name>Add --output-format argument to Chief CLI commands</name>
  <files>analysis/cli/chief.py</files>
  <action>
    Add output_format parameter to all three Chief CLI commands:

    1. Import Literal type from typing (add to imports at top of file):
       ```python
       from typing import Literal
       ```

    2. For each command (trends, seasonality, covid), add the output_format parameter after the existing parameters:
       ```python
       output_format: Literal["png", "svg", "pdf"] = typer.Option("png", help="Figure output format")
       ```

    3. Pass output_format to the config object for each command:
       - trends: config = TrendsConfig(..., output_format=output_format)
       - seasonality: config = SeasonalityConfig(..., output_format=output_format)
       - covid: config = COVIDConfig(..., output_format=output_format)

    4. Update config schema imports if needed - check analysis/config/schemas/chief.py to ensure output_format is accepted

    DO NOT:
    - Do not add figure generation code in this task (plan 07-10 handles wiring)
    - Do not modify test files (plan 07-10 handles test updates)
  </action>
  <verify>
    Run: python -m analysis.cli chief trends --help
    Expected: --output-format option appears in help output with choices [png, svg, pdf]
    Run: python -m analysis.cli chief seasonality --help
    Expected: --output-format option appears in help output
    Run: python -m analysis.cli chief covid --help
    Expected: --output-format option appears in help output
  </verify>
  <done>
    All three Chief CLI commands accept --output-format argument with default value "png".
    The parameter is passed to config objects for use in figure generation.
  </done>
</task>

<task type="auto">
  <name>Add --output-format argument to Forecasting CLI commands</name>
  <files>analysis/cli/forecasting.py</files>
  <action>
    Add output_format parameter to both Forecasting CLI commands:

    1. Import Literal type from typing (add to imports at top of file):
       ```python
       from typing import Literal
       ```

    2. For each command (time-series, classification), add the output_format parameter after the existing parameters:
       ```python
       output_format: Literal["png", "svg", "pdf"] = typer.Option("png", help="Figure output format")
       ```

    3. Pass output_format to the config object for each command:
       - time-series: config = TimeSeriesConfig(..., output_format=output_format)
       - classification: config = ClassificationConfig(..., output_format=output_format)

    4. Update config schema imports if needed - check analysis/config/schemas/forecasting.py to ensure output_format is accepted

    DO NOT:
    - Do not add figure generation code in this task (plan 07-10 handles wiring)
    - Do not modify test files (plan 07-10 handles test updates)
  </action>
  <verify>
    Run: python -m analysis.cli forecasting time-series --help
    Expected: --output-format option appears in help output with choices [png, svg, pdf]
    Run: python -m analysis.cli forecasting classification --help
    Expected: --output-format option appears in help output
  </verify>
  <done>
    Both Forecasting CLI commands accept --output-format argument with default value "png".
    The parameter is passed to config objects for use in figure generation.
  </done>
</task>

</tasks>

<verification>
After completing all tasks, verify:

1. All Chief and Forecasting commands accept --output-format:
   ```bash
   python -m analysis.cli chief trends --help | grep output-format
   python -m analysis.cli chief seasonality --help | grep output-format
   python -m analysis.cli chief covid --help | grep output-format
   python -m analysis.cli forecasting time-series --help | grep output-format
   python -m analysis.cli forecasting classification --help | grep output-format
   ```

2. Commands still execute successfully with default format:
   ```bash
   python -m analysis.cli chief trends --fast --version test
   python -m analysis.cli forecasting time-series --fast --version test
   ```

3. Commands accept explicit format values:
   ```bash
   python -m analysis.cli chief trends --output-format svg --fast --version test
   python -m analysis.cli chief trends --output-format pdf --fast --version test
   ```
</verification>

<success_criteria>
- [ ] All Chief CLI commands (trends, seasonality, covid) have --output-format argument
- [ ] All Forecasting CLI commands (time-series, classification) have --output-format argument
- [ ] Default value is "png" for all commands
- [ ] Valid choices are: png, svg, pdf
- [ ] Commands execute successfully with default format
- [ ] Commands execute successfully with explicit format values
- [ ] output_format is passed to config objects for use in figure generation
</success_criteria>

<output>
After completion, create `.planning/phases/07-visualization-testing/07-08-SUMMARY.md`
</output>
