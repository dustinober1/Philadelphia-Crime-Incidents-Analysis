---
phase: 04-forecasting-predictive
plan: 03
type: execute
wave: 2
depends_on: [04-01]
files_modified:
  - notebooks/04_classification_violence.ipynb
autonomous: true

must_haves:
  truths:
    - Crime incidents can be classified as violent vs non-violent
    - Classification model uses time-aware validation
    - Feature importance plot is generated showing top predictors
    - Model card with limitations and performance metrics is created
    - Notebook runs end-to-end without errors
  artifacts:
    - 04_classification_violence.ipynb with complete classification pipeline
    - Classification model trained with time-aware validation
    - Feature importance visualization exported to reports/
    - Model card document describing limitations and performance
    - Reproducible model with fixed random seed
  key_links:
    - notebook imports from analysis.models.classification
    - data properly prepared with temporal ordering maintained
    - train/test split uses time-based splitting (no shuffling)
    - feature importance extracted using built-in methods or SHAP
    - model card includes performance metrics and caveats
---

<objective>
Create a classification notebook that predicts whether incidents are violent or non-violent using scikit-learn/XGBoost, includes feature importance analysis, and produces a model card as required by FORECAST-02.

Purpose: Build and validate a classification model to identify violent incidents for resource allocation
Output: Classification model notebook with feature importance and model card documentation
</objective>

<execution_context>
@/Users/dustinober/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/dustinober/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-forecasting-predictive-modeling/04-RESEARCH.md
@data/crime_incidents_combined.parquet
</context>

<tasks>

<task type="auto">
  <name>Create classification data preparation and feature engineering</name>
  <files>notebooks/04_classification_violence.ipynb</files>
  <action>
Create the initial notebook structure that:
1. Loads crime incidents data from data/crime_incidents_combined.parquet
2. Creates a binary target variable for violent vs non-violent classification
3. Engineers features suitable for classification (dates, categories, locations, etc.)
4. Prepares the dataset with proper temporal ordering maintained
5. Includes exploratory analysis showing class distribution

Ensure that temporal order is preserved for time-aware validation.
</action>
  <verify>Data is loaded and engineered with binary violence target, preserving temporal order</verify>
  <done>Crime data loaded with violent classification target and engineered features prepared</done>
</task>

<task type="auto">
  <name>Implement classification model with time-aware validation</name>
  <files>notebooks/04_classification_violence.ipynb</files>
  <action>
Build the classification model following Pattern 2 from research:
1. Use TimeSeriesSplit for validation to prevent data leakage
2. Implement either Random Forest or XGBoost as recommended
3. Train the model using time-ordered data splits
4. Calculate performance metrics (accuracy, precision, recall, F1, ROC-AUC)
5. Perform hyperparameter tuning if needed

Avoid the anti-pattern of using random train/test splits for time series data.
</action>
  <verify>Model trains with time-aware validation and achieves reasonable performance</verify>
  <done>Classification model trained with time-aware validation and performance metrics calculated</done>
</task>

<task type="auto">
  <name>Add feature importance analysis and model card</name>
  <files>notebooks/04_classification_violence.ipynb</files>
  <action>
Complete the notebook with:
1. Feature importance analysis using built-in methods or SHAP
2. Export of feature importance visualization to reports/ directory
3. Creation of a model card documenting:
   - Model architecture and parameters
   - Performance metrics and limitations
   - Potential bias and fairness considerations
   - Intended use cases and warnings
4. Summary of findings and operational recommendations
</action>
  <verify>Feature importance plot generated and model card created with performance metrics and limitations</verify>
  <done>Feature importance visualization exported and model card created documenting model characteristics</done>
</task>

</tasks>

<verification>
- Run notebook completely to ensure end-to-end execution
- Verify time-aware validation is used (no random shuffling)
- Check that feature importance is calculated properly
- Confirm model card includes all required information
</verification>

<success_criteria>
- Classification notebook runs successfully end-to-end
- Model uses time-aware validation to prevent data leakage
- Feature importance plot generated and exported to reports/
- Model card includes architecture, performance metrics, and limitations
- Model includes reproducible training seed
</success_criteria>

<output>
After completion, create `.planning/phases/04-forecasting-predictive/04-03-SUMMARY.md`
</output>