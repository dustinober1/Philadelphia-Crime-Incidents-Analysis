---
phase: 04-forecasting-predictive
plan: 04
type: execute
wave: 2
depends_on: [04-01]
files_modified:
  - notebooks/04_hypothesis_heat_crime.ipynb
autonomous: true

must_haves:
  truths:
    - Weather and crime data can be merged properly based on temporal and spatial alignment
    - Correlation analysis between temperature and crime rates is performed
    - Hypothesis test results are calculated for heat-crime relationship
    - Join strategy between weather and crime data is documented
    - Notebook runs end-to-end without errors
  artifacts:
    - 04_hypothesis_heat_crime.ipynb with complete heat-crime analysis
    - Merged dataset of weather and crime data with documented methodology
    - Correlation plots between temperature and crime types
    - Statistical test results with p-values and effect sizes
    - Documentation of join strategy and limitations
  key_links:
    - weather data from data/external/weather_philly_2006_2026.parquet is joined with crime data
    - temporal alignment between hourly weather data and daily crime aggregation
    - correlation analysis follows scipy.stats methodology
    - spatial join strategy is documented (closest weather station approach)
    - hypothesis test results include significance levels and effect sizes
---

<objective>
Create a hypothesis testing notebook that merges hourly weather data with crime data to test heat-crime relationships as required by HYP-HEAT, including correlation analysis and statistical testing.

Purpose: Investigate statistical relationships between temperature and crime patterns for policy insights
Output: Heat-crime correlation analysis notebook with documented merge strategy and test results
</objective>

<execution_context>
@/Users/dustinober/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/dustinober/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-forecasting-predictive-modeling/04-RESEARCH.md
@data/crime_incidents_combined.parquet
@data/external/weather_philly_2006_2026.parquet
</context>

<tasks>

<task type="auto">
  <name>Merge weather and crime data with documented strategy</name>
  <files>notebooks/04_hypothesis_heat_crime.ipynb</files>
  <action>
Create the initial notebook structure that:
1. Loads crime incidents data from data/crime_incidents_combined.parquet
2. Loads weather data from data/external/weather_philly_2006_2026.parquet
3. Implements a documented strategy to merge data (addressing Open Question #2 from research)
4. Documents the join strategy including temporal and spatial alignment approaches
5. Shows preliminary exploration of both datasets

Address the geographic granularity challenge by using the closest weather station to crime districts as suggested in the research.
</action>
  <verify>Weather and crime datasets loaded successfully and merged with documented strategy</verify>
  <done>Weather and crime data loaded with documented merge strategy implemented</done>
</task>

<task type="auto">
  <name>Perform correlation analysis between temperature and crime</name>
  <files>notebooks/04_hypothesis_heat_crime.ipynb</files>
  <action>
Perform the correlation analysis following Pattern 3 from research:
1. Aggregate crime data to align with weather data temporal resolution
2. Calculate correlations between temperature and different crime types (especially violent crimes)
3. Use multiple correlation methods (Pearson, Spearman, Kendall tau)
4. Generate correlation plots and visualizations
5. Calculate effect sizes and significance levels

Follow the statistical analysis methodology from the research code examples.
</action>
  <verify>Correlation analysis completed with multiple methods and significance testing</verify>
  <done>Multiple correlation methods applied with significance testing and effect sizes calculated</done>
</task>

<task type="auto">
  <name>Conduct hypothesis testing and create documentation</name>
  <files>notebooks/04_hypothesis_heat_crime.ipynb</files>
  <action>
Complete the notebook with:
1. Formal hypothesis tests for heat-crime relationships
2. Statistical test results with p-values and confidence intervals
3. Documentation of the join strategy and any limitations
4. Export of correlation plots and statistical results to reports/ directory
5. Summary of findings regarding temperature thresholds and crime patterns
</action>
  <verify>Statistical tests completed with p-values, and join strategy documented</verify>
  <done>Hypothesis test results calculated with proper documentation of merge methodology</done>
</task>

</tasks>

<verification>
- Run notebook completely to ensure end-to-end execution
- Verify weather and crime data merge properly
- Check that correlation analysis is statistically sound
- Confirm join strategy is properly documented
</verification>

<success_criteria>
- Heat-crime hypothesis notebook runs successfully end-to-end
- Weather and crime data merged with documented spatial/temporal alignment
- Correlation analysis completed with proper statistical testing
- Results include significance levels, effect sizes, and p-values
- Documentation of join strategy and methodology provided
</success_criteria>

<output>
After completion, create `.planning/phases/04-forecasting-predictive/04-04-SUMMARY.md`
</output>
