---
phase: 04-forecasting-predictive
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - environment.yml
  - notebooks/04_forecasting_crime_ts.ipynb
  - notebooks/04_classification_violence.ipynb
  - notebooks/04_hypothesis_heat_crime.ipynb
  - analysis/models/time_series.py
  - analysis/models/classification.py
  - analysis/models/validation.py
  - analysis/visualization/forecast_plots.py
autonomous: true

must_haves:
  truths:
    - All required libraries for forecasting and classification are installed
    - Template notebooks are created for each modeling task
    - Model utility modules are set up
    - Visualization utilities are available
  artifacts:
    - environment.yml with forecasting libraries (prophet, xgboost, shap, scipy)
    - Empty notebook templates in notebooks/ directory
    - Model utility modules in analysis/models/
    - Forecast visualization utilities in analysis/visualization/
  key_links:
    - environment.yml installs prophet and xgboost via conda
    - notebooks import analysis.models utilities
    - utils use absolute paths via __file__
---

<objective>
Set up the infrastructure and environment for Phase 4 forecasting and predictive modeling work, including installing required libraries, creating notebook templates, and establishing model utility modules.

Purpose: Prepare the technical foundation for time series forecasting, classification modeling, and heat-crime analysis
Output: Environment configured with required libraries and notebook templates ready for development
</objective>

<execution_context>
@/Users/dustinober/.config/opencode/get-shit-done/workflows/execute-plan.md
@/Users/dustinober/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-forecasting-predictive-modeling/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Update environment with forecasting libraries</name>
  <files>environment.yml</files>
  <action>
Update the conda environment file to include all required libraries for Phase 4:
- prophet for time series forecasting
- xgboost and scikit-learn for classification
- shap for feature importance interpretation
- scipy and statsmodels for statistical analysis
- seaborn and plotly for visualization

Follow the conda install recommendations from the research file. Make sure to include all the libraries mentioned in the Standard Stack section of the research file.
</action>
  <verify>conda env update -f environment.yml completes without errors</verify>
  <done>Environment.yml includes all required libraries for forecasting, classification, and statistical analysis</done>
</task>

<task type="auto">
  <name>Create model utility modules</name>
  <files>
  - analysis/models/time_series.py
  - analysis/models/classification.py
  - analysis/models/validation.py
  </files>
  <action>
Create three model utility modules following the architecture pattern from research:

1. analysis/models/time_series.py: Contains utilities for time series preprocessing, Prophet model configuration, and forecast evaluation
2. analysis/models/classification.py: Contains utilities for classification model training, time-aware validation, and feature importance extraction
3. analysis/models/validation.py: Contains utilities for time series cross-validation and model evaluation metrics

Use absolute path resolution (__file__) for all internal imports to ensure modules work regardless of working directory.
</action>
  <verify>python -c "import analysis.models.time_series; import analysis.models.classification; import analysis.models.validation"</verify>
  <done>Three model utility modules created with proper absolute path imports and basic functionality</done>
</task>

<task type="auto">
  <name>Create forecast visualization utilities</name>
  <files>analysis/visualization/forecast_plots.py</files>
  <action>
Create forecast visualization utilities module that contains functions for:
- Time series forecast plots with confidence intervals
- Residual diagnostic plots
- Feature importance visualizations for classification models
- Correlation matrix plots for statistical analysis
- Anomaly detection visualization

Follow the existing visualization patterns from previous phases, use absolute path resolution via __file__, and ensure functions return matplotlib/plotly objects suitable for embedding in notebooks.
</action>
  <verify>python -c "from analysis.visualization.forecast_plots import *"</verify>
  <done>Forecast visualization utilities module created with functions for all required plots</done>
</task>

</tasks>

<verification>
- Confirm all required libraries are available for import
- Verify all utility modules can be imported without errors
- Check that environment.yml contains all packages listed in research
</verification>

<success_criteria>
- Environment updated with all required libraries (prophet, xgboost, shap, scipy, etc.)
- Model utility modules created and importable (time_series.py, classification.py, validation.py)
- Visualization utilities created (forecast_plots.py)
- All modules use absolute path resolution for consistency
</success_criteria>

<output>
After completion, create `.planning/phases/04-forecasting-predictive/04-01-SUMMARY.md`
</output>
