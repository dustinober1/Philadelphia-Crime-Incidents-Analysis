---
phase: 14-repository-cleanup
plan: 04
type: execute
wave: 2
depends_on: [14-01]
files_modified: [analysis/*.py, api/*.py, pipeline/*.py]
autonomous: true
user_setup: []

must_haves:
  truths:
    - "All unused imports removed from Python files"
    - "No import errors after cleanup (verified with lint check)"
    - "Package exports remain functional after import cleanup"
  artifacts:
    - path: "analysis/*.py, api/*.py, pipeline/*.py"
      provides: "Python source code with cleaned imports"
      min_lines: 1
    - path: ".planning/phases/14-repository-cleanup/autoflake-log.txt"
      provides: "Autoflake execution log"
      contains: "Unused imports removed|No unused imports found"
  key_links:
    - from: "autoflake"
      to: "Python files"
      via: "autoflake --in-place command"
      pattern: "analysis/|api/|pipeline/"
---

<objective>
Remove unused imports from Python files using autoflake.

Purpose: Automate removal of import statements that are not used in the code. Unused imports create code noise and waste import time. Autoflake is safer than manual removal because it understands import dependencies.

Output: Python files with only necessary imports, autoflake execution log documenting changes.
</objective>

<execution_context>
@/Users/dustinober/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dustinober/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/milestones/v1.3-ROADMAP.md
@.planning/research/STACK-testing-cleanup.md
</context>

<tasks>

<task type="auto">
  <name>Run autoflake dry-run to preview removals</name>
  <files>analysis/*.py, api/*.py, pipeline/*.py</files>
  <action>
    Run autoflake in dry-run mode to preview what will be changed without modifying files:

    ```bash
    autoflake --remove-all-unused-imports --recursive analysis/ api/ pipeline/ --dry-run > .planning/phases/14-repository-cleanup/autoflake-dryrun.txt 2>&1
    ```

    Command flags:
    - --remove-all-unused-imports: Remove all unused imports (including __future__)
    - --recursive: Process all subdirectories
    - --dry-run: Show changes without applying them

    Save output to autoflake-dryrun.txt for review before making actual changes.

    Reference: .planning/research/STACK-testing-cleanup.md lines 211-214
  </action>
  <verify>test -s .planning/phases/14-repository-cleanup/autoflake-dryrun.txt</verify>
  <done>autoflake-dryrun.txt shows preview of unused imports to be removed</done>
</task>

<task type="auto">
  <name>Run autoflake in-place to remove unused imports</name>
  <files>analysis/*.py, api/*.py, pipeline/*.py</files>
  <action>
    Run autoflake with --in-place to actually remove unused imports:

    ```bash
    autoflake --remove-all-unused-imports --recursive --in-place analysis/ api/ pipeline/ > .planning/phases/14-repository-cleanup/autoflake-log.txt 2>&1
    ```

    Command flags:
    - --in-place: Modify files directly (instead of printing to stdout)
    - Save execution log to autoflake-log.txt for documentation

    This will modify all Python files in analysis/, api/, and pipeline/ to remove import statements that are never referenced.
  </action>
  <verify>test -s .planning/phases/14-repository-cleanup/autoflake-log.txt && head -10 .planning/phases/14-repository-cleanup/autoflake-log.txt</verify>
  <done>autoflake-log.txt exists and documents import removal execution</done>
</task>

<task type="auto">
  <name>Verify no import errors after cleanup</name>
  <files>analysis/*.py, api/*.py, pipeline/*.py</files>
  <action>
    Verify that removing unused imports did not break code by running Python imports and linting:

    1. Test core package imports:
    ```bash
    python -c "import analysis; import api; import pipeline; print('Package imports OK')"
    ```

    2. Run ruff linting to check for import errors:
    ```bash
    ruff check analysis api pipeline --select F401
    ```

    F401 is the "imported but unused" error code. If this returns nothing, autoflake successfully removed all unused imports.

    If import errors appear, investigate whether autoflake removed a necessary import (false positive) and restore it manually.
  </action>
  <verify>python -c "import analysis; import api; import pipeline" && ruff check analysis api pipeline --select F401 --quiet</verify>
  <done>All packages import successfully and no F401 import errors remain</done>
</task>

<task type="auto">
  <name>Validate package exports still work</name>
  <files>analysis/__init__.py</files>
  <action>
    Verify that key package exports are still functional after import cleanup:

    ```bash
    python -c "
    from analysis import classify_crime_category, extract_temporal_features, load_data
    print('analysis exports OK')

    from api.main import app
    print('api exports OK')

    # Test that we can call these functions
    assert callable(classify_crime_category)
    assert callable(extract_temporal_features)
    assert callable(load_data)
    print('All exports are callable')
    "
    ```

    This ensures autoflake didn't remove imports that are re-exported in __init__.py files.
  </action>
  <verify>python -c "from analysis import classify_crime_category, extract_temporal_features, load_data; from api.main import app" 2>&1</verify>
  <done>All package exports (classify_crime_category, extract_temporal_features, load_data, FastAPI app) are functional</done>
</task>

</tasks>

<verification>
- autoflake-dryrun.txt created with preview of changes
- autoflake-log.txt documents actual removals made
- No import errors in any Python package
- ruff F401 check returns no errors
- All package imports work correctly
- Package exports remain functional
</verification>

<success_criteria>
- Unused imports successfully removed from all Python files
- No import errors or broken code
- ruff linting passes with no F401 errors
- Package exports still function correctly
- Execution logs document changes made
</success_criteria>

<output>
After completion, create `.planning/phases/14-repository-cleanup/14-04-SUMMARY.md`
</output>
